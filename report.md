# Aderyn Analysis Report

This report was generated by [Aderyn](https://github.com/Cyfrin/aderyn), a static analysis tool built by [Cyfrin](https://cyfrin.io), a blockchain security company. This report is not a substitute for manual audit or security review. It should not be relied upon for any purpose other than to assist in the identification of potential security vulnerabilities.
# Table of Contents

- [Summary](#summary)
  - [Files Summary](#files-summary)
  - [Files Details](#files-details)
  - [Issue Summary](#issue-summary)
- [High Issues](#high-issues)
  - [H-1: Contract Name Reused in Different Files](#h-1-contract-name-reused-in-different-files)
  - [H-2: Weak Randomness](#h-2-weak-randomness)
  - [H-3: Reentrancy: State change after external call](#h-3-reentrancy-state-change-after-external-call)
- [Low Issues](#low-issues)
  - [L-1: Centralization Risk](#l-1-centralization-risk)
  - [L-2: Deprecated OpenZeppelin Function](#l-2-deprecated-openzeppelin-function)
  - [L-3: Unsafe ERC20 Operation](#l-3-unsafe-erc20-operation)
  - [L-4: Address State Variable Set Without Checks](#l-4-address-state-variable-set-without-checks)
  - [L-5: Public Function Not Used Internally](#l-5-public-function-not-used-internally)
  - [L-6: Large Numeric Literal](#l-6-large-numeric-literal)
  - [L-7: Loop Contains `require`/`revert`](#l-7-loop-contains-requirerevert)
  - [L-8: Uninitialized Local Variable](#l-8-uninitialized-local-variable)
  - [L-9: Costly operations inside loop](#l-9-costly-operations-inside-loop)
  - [L-10: State Change Without Event](#l-10-state-change-without-event)
  - [L-11: State Variable Could Be Immutable](#l-11-state-variable-could-be-immutable)
  - [L-12: Unchecked Return](#l-12-unchecked-return)


# Summary

## Files Summary

| Key | Value |
| --- | --- |
| .sol Files | 35 |
| Total nSLOC | 1811 |


## Files Details

| Filepath | nSLOC |
| --- | --- |
| src/DcaManager.sol | 389 |
| src/DcaManagerAccessControl.sol | 12 |
| src/External interaction examples/SovrynDepositWithdraw.sol | 42 |
| src/External interaction examples/UniswapSwap.sol | 1 |
| src/FeeHandler.sol | 102 |
| src/OperationsAdmin.sol | 65 |
| src/PurchaseMoc.sol | 79 |
| src/PurchaseRbtc.sol | 48 |
| src/PurchaseUniswap.sol | 173 |
| src/SovrynDocHandlerMoc.sol | 42 |
| src/SovrynErc20Handler.sol | 120 |
| src/SovrynErc20HandlerDex.sol | 49 |
| src/TokenHandler.sol | 46 |
| src/TokenLending.sol | 23 |
| src/TropykusDocHandlerMoc.sol | 42 |
| src/TropykusErc20Handler.sol | 148 |
| src/TropykusErc20HandlerDex.sol | 49 |
| src/interfaces/ICoinPairPrice.sol | 52 |
| src/interfaces/IDcaManager.sol | 111 |
| src/interfaces/IDcaManagerAccessControl.sol | 4 |
| src/interfaces/IDocHandler.sol | 4 |
| src/interfaces/IFeeHandler.sol | 26 |
| src/interfaces/IMocProxy.sol | 5 |
| src/interfaces/IOperationsAdmin.sol | 18 |
| src/interfaces/IPurchaseMoc.sol | 5 |
| src/interfaces/IPurchaseRbtc.sol | 29 |
| src/interfaces/IPurchaseUniswap.sol | 33 |
| src/interfaces/ISovrynErc20Lending.sol | 5 |
| src/interfaces/IStablecoin.sol | 9 |
| src/interfaces/ITokenHandler.sol | 10 |
| src/interfaces/ITokenLending.sol | 26 |
| src/interfaces/ITropykusErc20Lending.sol | 5 |
| src/interfaces/IWRBTC.sol | 18 |
| src/interfaces/IiSusdToken.sol | 9 |
| src/interfaces/IkToken.sol | 12 |
| **Total** | **1811** |


## Issue Summary

| Category | No. of Issues |
| --- | --- |
| High | 3 |
| Low | 12 |


# High Issues

## H-1: Contract Name Reused in Different Files

When compiling contracts with certain development frameworks (for example: Truffle), having contracts with the same name across different files can lead to one being overwritten.

<details><summary>1 Found Instances</summary>


- Found in src/External interaction examples/SovrynDepositWithdraw.sol [Line: 5](src/External interaction examples/SovrynDepositWithdraw.sol#L5)

	```solidity
	interface IERC20 {
	```

</details>



## H-2: Weak Randomness

The use of keccak256 hash functions on predictable values like block.timestamp, block.number, or similar data, including modulo operations on these values, should be avoided for generating randomness, as they are easily predictable and manipulable. The `PREVRANDAO` opcode also should not be used as a source of randomness. Instead, utilize Chainlink VRF for cryptographically secure and provably random values to ensure protocol integrity.

<details><summary>1 Found Instances</summary>


- Found in src/DcaManager.sol [Line: 151](src/DcaManager.sol#L151)

	```solidity
	            keccak256(abi.encodePacked(msg.sender, token, block.timestamp, schedules.length));
	```

</details>



## H-3: Reentrancy: State change after external call

Changing state after an external call can lead to re-entrancy attacks.Use the checks-effects-interactions pattern to avoid this issue.

<details><summary>9 Found Instances</summary>


- Found in src/DcaManager.sol [Line: 143](src/DcaManager.sol#L143)

	State is changed at: `schedules.push(dcaSchedule)`
	```solidity
	        _handler(token, lendingProtocolIndex).depositToken(msg.sender, depositAmount);
	```

- Found in src/DcaManager.sol [Line: 194](src/DcaManager.sol#L194)

	State is changed at: `s_dcaSchedules[msg.sender][token][scheduleIndex] = dcaSchedule`
	```solidity
	            _handler(token, dcaSchedule.lendingProtocolIndex).depositToken(msg.sender, depositAmount);
	```

- Found in src/OperationsAdmin.sol [Line: 51](src/OperationsAdmin.sol#L51)

	State is changed at: `s_tokenHandler[key] = handler`
	```solidity
	        if (tokenHandler.supportsInterface(type(ITokenHandler).interfaceId)) {
	```

- Found in src/SovrynErc20Handler.sol [Line: 59](src/SovrynErc20Handler.sol#L59)

	State is changed at: `s_iSusdBalances[user] += mintedAmount`
	```solidity
	        if (i_stableToken.allowance(address(this), address(i_iSusdToken)) < depositAmount) {
	```

- Found in src/SovrynErc20Handler.sol [Line: 62](src/SovrynErc20Handler.sol#L62)

	State is changed at: `s_iSusdBalances[user] += mintedAmount`
	```solidity
	        uint256 mintedAmount = i_iSusdToken.mint(address(this), depositAmount);
	```

- Found in src/TropykusErc20Handler.sol [Line: 59](src/TropykusErc20Handler.sol#L59)

	State is changed at: `s_kTokenBalances[user] += postKtokenBalance - prevKtokenBalance`
	```solidity
	        if (i_stableToken.allowance(address(this), address(i_kToken)) < depositAmount) {
	```

- Found in src/TropykusErc20Handler.sol [Line: 62](src/TropykusErc20Handler.sol#L62)

	State is changed at: `s_kTokenBalances[user] += postKtokenBalance - prevKtokenBalance`
	```solidity
	        uint256 prevKtokenBalance = i_kToken.balanceOf(address(this));
	```

- Found in src/TropykusErc20Handler.sol [Line: 63](src/TropykusErc20Handler.sol#L63)

	State is changed at: `s_kTokenBalances[user] += postKtokenBalance - prevKtokenBalance`
	```solidity
	        if(i_kToken.mint(depositAmount) != 0) revert TokenLending__LendingProtocolDepositFailed();
	```

- Found in src/TropykusErc20Handler.sol [Line: 64](src/TropykusErc20Handler.sol#L64)

	State is changed at: `s_kTokenBalances[user] += postKtokenBalance - prevKtokenBalance`
	```solidity
	        uint256 postKtokenBalance = i_kToken.balanceOf(address(this));
	```

</details>



# Low Issues

## L-1: Centralization Risk

Contracts have owners with privileged rights to perform admin tasks and need to be trusted to not perform malicious updates or drain funds.

<details><summary>30 Found Instances</summary>


- Found in src/DcaManager.sol [Line: 18](src/DcaManager.sol#L18)

	```solidity
	contract DcaManager is IDcaManager, Ownable, ReentrancyGuard {
	```

- Found in src/DcaManager.sol [Line: 381](src/DcaManager.sol#L381)

	```solidity
	    function setOperationsAdmin(address operationsAdminAddress) external override onlyOwner {
	```

- Found in src/DcaManager.sol [Line: 390](src/DcaManager.sol#L390)

	```solidity
	    function modifyMinPurchasePeriod(uint256 minPurchasePeriod) external override onlyOwner {
	```

- Found in src/DcaManager.sol [Line: 399](src/DcaManager.sol#L399)

	```solidity
	    function modifyMaxSchedulesPerToken(uint256 maxSchedulesPerToken) external override onlyOwner {
	```

- Found in src/DcaManager.sol [Line: 637](src/DcaManager.sol#L637)

	```solidity
	        onlyOwner
	```

- Found in src/DcaManager.sol [Line: 647](src/DcaManager.sol#L647)

	```solidity
	    function getUsers() external view override onlyOwner returns (address[] memory) {
	```

- Found in src/FeeHandler.sol [Line: 13](src/FeeHandler.sol#L13)

	```solidity
	abstract contract FeeHandler is IFeeHandler, Ownable {
	```

- Found in src/FeeHandler.sol [Line: 49](src/FeeHandler.sol#L49)

	```solidity
	        onlyOwner
	```

- Found in src/FeeHandler.sol [Line: 61](src/FeeHandler.sol#L61)

	```solidity
	    function setMinFeeRate(uint256 minFeeRate) public override onlyOwner {
	```

- Found in src/FeeHandler.sol [Line: 70](src/FeeHandler.sol#L70)

	```solidity
	    function setMaxFeeRate(uint256 maxFeeRate) public override onlyOwner {
	```

- Found in src/FeeHandler.sol [Line: 79](src/FeeHandler.sol#L79)

	```solidity
	    function setPurchaseLowerBound(uint256 purchaseLowerBound) public override onlyOwner {
	```

- Found in src/FeeHandler.sol [Line: 88](src/FeeHandler.sol#L88)

	```solidity
	    function setPurchaseUpperBound(uint256 purchaseUpperBound) public override onlyOwner {
	```

- Found in src/FeeHandler.sol [Line: 97](src/FeeHandler.sol#L97)

	```solidity
	    function setFeeCollectorAddress(address feeCollector) external override onlyOwner {
	```

- Found in src/OperationsAdmin.sol [Line: 15](src/OperationsAdmin.sol#L15)

	```solidity
	contract OperationsAdmin is IOperationsAdmin, Ownable, AccessControl {
	```

- Found in src/OperationsAdmin.sol [Line: 42](src/OperationsAdmin.sol#L42)

	```solidity
	        onlyRole(ADMIN_ROLE)
	```

- Found in src/OperationsAdmin.sol [Line: 64](src/OperationsAdmin.sol#L64)

	```solidity
	    function setSwapperRole(address swapper) external onlyRole(ADMIN_ROLE) {
	```

- Found in src/OperationsAdmin.sol [Line: 72](src/OperationsAdmin.sol#L72)

	```solidity
	    function revokeSwapperRole(address swapper) external onlyRole(ADMIN_ROLE) {
	```

- Found in src/OperationsAdmin.sol [Line: 80](src/OperationsAdmin.sol#L80)

	```solidity
	    function setAdminRole(address admin) external onlyOwner {
	```

- Found in src/OperationsAdmin.sol [Line: 88](src/OperationsAdmin.sol#L88)

	```solidity
	    function revokeAdminRole(address admin) external onlyOwner {
	```

- Found in src/OperationsAdmin.sol [Line: 109](src/OperationsAdmin.sol#L109)

	```solidity
	    function addOrUpdateLendingProtocol(string memory lowerCaseName, uint256 index) external onlyRole(ADMIN_ROLE) {
	```

- Found in src/PurchaseRbtc.sol [Line: 12](src/PurchaseRbtc.sol#L12)

	```solidity
	abstract contract PurchaseRbtc is IPurchaseRbtc, Ownable, DcaManagerAccessControl {
	```

- Found in src/PurchaseRbtc.sol [Line: 38](src/PurchaseRbtc.sol#L38)

	```solidity
	    function withdrawStuckRbtc(address stuckUserContract, address rescueAddress) external virtual onlyOwner {
	```

- Found in src/PurchaseUniswap.sol [Line: 168](src/PurchaseUniswap.sol#L168)

	```solidity
	    function withdrawStuckRbtc(address stuckUserContract, address rescueAddress) external override onlyOwner {
	```

- Found in src/PurchaseUniswap.sol [Line: 182](src/PurchaseUniswap.sol#L182)

	```solidity
	        onlyOwner
	```

- Found in src/PurchaseUniswap.sol [Line: 203](src/PurchaseUniswap.sol#L203)

	```solidity
	    function setAmountOutMinimumPercent(uint256 amountOutMinimumPercent) external onlyOwner {
	```

- Found in src/PurchaseUniswap.sol [Line: 218](src/PurchaseUniswap.sol#L218)

	```solidity
	    function setAmountOutMinimumSafetyCheck(uint256 amountOutMinimumSafetyCheck) external onlyOwner {
	```

- Found in src/PurchaseUniswap.sol [Line: 230](src/PurchaseUniswap.sol#L230)

	```solidity
	    function updateMocOracle(address newOracle) external override onlyOwner {
	```

- Found in src/TokenHandler.sol [Line: 16](src/TokenHandler.sol#L16)

	```solidity
	abstract contract TokenHandler is ITokenHandler, ERC165, Ownable, FeeHandler, DcaManagerAccessControl {
	```

- Found in src/TokenHandler.sol [Line: 85](src/TokenHandler.sol#L85)

	```solidity
	    function modifyMinPurchaseAmount(uint256 minPurchaseAmount) external override onlyOwner {
	```

</details>



## L-2: Deprecated OpenZeppelin Function

Openzeppelin has deprecated several functions and replaced with newer versions. Please consult https://docs.openzeppelin.com/

<details><summary>3 Found Instances</summary>


- Found in src/PurchaseUniswap.sol [Line: 280](src/PurchaseUniswap.sol#L280)

	```solidity
	        TransferHelper.safeApprove(address(i_purchasingToken), address(i_swapRouter02), stablecoinAmountToSpend);
	```

- Found in src/SovrynErc20Handler.sol [Line: 60](src/SovrynErc20Handler.sol#L60)

	```solidity
	            i_stableToken.safeApprove(address(i_iSusdToken), depositAmount);
	```

- Found in src/TropykusErc20Handler.sol [Line: 60](src/TropykusErc20Handler.sol#L60)

	```solidity
	            i_stableToken.safeApprove(address(i_kToken), depositAmount);
	```

</details>



## L-3: Unsafe ERC20 Operation

ERC20 functions may not behave as expected. For example: return values are not always meaningful. It is recommended to use OpenZeppelin's SafeERC20 library.

<details><summary>2 Found Instances</summary>


- Found in src/External interaction examples/SovrynDepositWithdraw.sol [Line: 40](src/External interaction examples/SovrynDepositWithdraw.sol#L40)

	```solidity
	        docToken.transferFrom(msg.sender, address(this), amount);
	```

- Found in src/External interaction examples/SovrynDepositWithdraw.sol [Line: 41](src/External interaction examples/SovrynDepositWithdraw.sol#L41)

	```solidity
	        docToken.approve(address(loanTokenProxy), amount);
	```

</details>



## L-4: Address State Variable Set Without Checks

Check for `address(0)` when assigning values to address state variables.

<details><summary>9 Found Instances</summary>


- Found in src/DcaManager.sol [Line: 70](src/DcaManager.sol#L70)

	```solidity
	        s_operationsAdmin = OperationsAdmin(operationsAdminAddress);
	```

- Found in src/DcaManager.sol [Line: 382](src/DcaManager.sol#L382)

	```solidity
	        s_operationsAdmin = OperationsAdmin(operationsAdminAddress);
	```

- Found in src/External interaction examples/SovrynDepositWithdraw.sol [Line: 34](src/External interaction examples/SovrynDepositWithdraw.sol#L34)

	```solidity
	        docToken = IERC20(_docToken);
	```

- Found in src/External interaction examples/SovrynDepositWithdraw.sol [Line: 35](src/External interaction examples/SovrynDepositWithdraw.sol#L35)

	```solidity
	        iSUSD = IERC20(_loanTokenProxy);
	```

- Found in src/External interaction examples/SovrynDepositWithdraw.sol [Line: 36](src/External interaction examples/SovrynDepositWithdraw.sol#L36)

	```solidity
	        loanTokenProxy = ILoanTokenLogicLM(_loanTokenProxy);
	```

- Found in src/FeeHandler.sol [Line: 28](src/FeeHandler.sol#L28)

	```solidity
	        s_feeCollector = feeCollector;
	```

- Found in src/FeeHandler.sol [Line: 98](src/FeeHandler.sol#L98)

	```solidity
	        s_feeCollector = feeCollector;
	```

- Found in src/PurchaseUniswap.sol [Line: 54](src/PurchaseUniswap.sol#L54)

	```solidity
	        s_mocOracle = uniswapSettings.mocOracle;
	```

- Found in src/TokenHandler.sol [Line: 38](src/TokenHandler.sol#L38)

	```solidity
	        s_feeCollector = feeCollector;
	```

</details>



## L-5: Public Function Not Used Internally

If a function is marked public but is not used internally, consider marking it as `external`.

<details><summary>1 Found Instances</summary>


- Found in src/OperationsAdmin.sol [Line: 98](src/OperationsAdmin.sol#L98)

	```solidity
	    function getTokenHandler(address token, uint256 lendingProtocolIndex) public view returns (address) {
	```

</details>



## L-6: Large Numeric Literal

Large literal values multiples of 10000 can be replaced with scientific notation.Use `e` notation, for example: `1e18`, instead of its full numeric value.

<details><summary>1 Found Instances</summary>


- Found in src/FeeHandler.sol [Line: 25](src/FeeHandler.sol#L25)

	```solidity
	    uint256 constant FEE_PERCENTAGE_DIVISOR = 10_000; // feeRate will belong to [100, 200], so we need to divide by 10,000 (100 * 100)
	```

</details>



## L-7: Loop Contains `require`/`revert`

Avoid `require` / `revert` statements in a loop because a single bad item can cause the whole transaction to fail. It's better to forgive on fail and return failed elements post processing of the loop

<details><summary>4 Found Instances</summary>


- Found in src/DcaManager.sol [Line: 310](src/DcaManager.sol#L310)

	```solidity
	        for (uint256 i; i < numOfPurchases; ++i) {
	```

- Found in src/DcaManager.sol [Line: 336](src/DcaManager.sol#L336)

	```solidity
	        for (uint256 i; i < depositedTokens.length; ++i) {
	```

- Found in src/DcaManager.sol [Line: 337](src/DcaManager.sol#L337)

	```solidity
	            for (uint256 j; j < lendingProtocolIndexes.length; ++j) {
	```

- Found in src/DcaManager.sol [Line: 372](src/DcaManager.sol#L372)

	```solidity
	        for (uint256 i; i < lendingProtocolIndexes.length; ++i) {
	```

</details>



## L-8: Uninitialized Local Variable

Initialize all the variables. If a variable is meant to be initialized to zero, explicitly set it to zero to improve code readability.

<details><summary>6 Found Instances</summary>


- Found in src/DcaManager.sol [Line: 310](src/DcaManager.sol#L310)

	```solidity
	        for (uint256 i; i < numOfPurchases; ++i) {
	```

- Found in src/DcaManager.sol [Line: 336](src/DcaManager.sol#L336)

	```solidity
	        for (uint256 i; i < depositedTokens.length; ++i) {
	```

- Found in src/DcaManager.sol [Line: 337](src/DcaManager.sol#L337)

	```solidity
	            for (uint256 j; j < lendingProtocolIndexes.length; ++j) {
	```

- Found in src/DcaManager.sol [Line: 372](src/DcaManager.sol#L372)

	```solidity
	        for (uint256 i; i < lendingProtocolIndexes.length; ++i) {
	```

- Found in src/DcaManager.sol [Line: 537](src/DcaManager.sol#L537)

	```solidity
	        for (uint256 i; i < dcaSchedules.length; ++i) {
	```

- Found in src/DcaManager.sol [Line: 709](src/DcaManager.sol#L709)

	```solidity
	        for (uint256 i; i < dcaSchedules.length; ++i) {
	```

</details>



## L-9: Costly operations inside loop

Invoking `SSTORE` operations in loops may waste gas. Use a local variable to hold the loop computation result.

<details><summary>5 Found Instances</summary>


- Found in src/DcaManager.sol [Line: 310](src/DcaManager.sol#L310)

	```solidity
	        for (uint256 i; i < numOfPurchases; ++i) {
	```

- Found in src/PurchaseMoc.sol [Line: 98](src/PurchaseMoc.sol#L98)

	```solidity
	            for (uint256 i; i < numOfPurchases; ++i) {
	```

- Found in src/PurchaseUniswap.sol [Line: 134](src/PurchaseUniswap.sol#L134)

	```solidity
	            for (uint256 i; i < numOfPurchases; ++i) {
	```

- Found in src/SovrynErc20Handler.sol [Line: 201](src/SovrynErc20Handler.sol#L201)

	```solidity
	        for (uint256 i; i < numOfPurchases; ++i) {
	```

- Found in src/TropykusErc20Handler.sol [Line: 218](src/TropykusErc20Handler.sol#L218)

	```solidity
	        for (uint256 i; i < numOfPurchases; ++i) {
	```

</details>



## L-10: State Change Without Event

There are state variable changes in this function but no event is emitted. Consider emitting an event to enable offchain indexers to track the changes.

<details><summary>3 Found Instances</summary>


- Found in src/DcaManager.sol [Line: 326](src/DcaManager.sol#L326)

	```solidity
	    function withdrawRbtcFromTokenHandler(address token, uint256 lendingProtocolIndex) external override nonReentrant {
	```

- Found in src/DcaManager.sol [Line: 334](src/DcaManager.sol#L334)

	```solidity
	    function withdrawAllAccumulatedRbtc(uint256[] calldata lendingProtocolIndexes) external override nonReentrant {
	```

- Found in src/DcaManager.sol [Line: 367](src/DcaManager.sol#L367)

	```solidity
	    function withdrawAllAccumulatedInterest(address token, uint256[] calldata lendingProtocolIndexes)
	```

</details>



## L-11: State Variable Could Be Immutable

State variables that are only changed in the constructor should be declared immutable to save gas. Add the `immutable` attribute to state variables that are only changed in the constructor

<details><summary>3 Found Instances</summary>


- Found in src/External interaction examples/SovrynDepositWithdraw.sol [Line: 27](src/External interaction examples/SovrynDepositWithdraw.sol#L27)

	```solidity
	    IERC20 docToken;
	```

- Found in src/External interaction examples/SovrynDepositWithdraw.sol [Line: 28](src/External interaction examples/SovrynDepositWithdraw.sol#L28)

	```solidity
	    IERC20 iSUSD;
	```

- Found in src/External interaction examples/SovrynDepositWithdraw.sol [Line: 29](src/External interaction examples/SovrynDepositWithdraw.sol#L29)

	```solidity
	    ILoanTokenLogicLM loanTokenProxy;
	```

</details>



## L-12: Unchecked Return

Function returns a value but it is ignored. Consider checking the return value.

<details><summary>8 Found Instances</summary>


- Found in src/DcaManager.sol [Line: 314](src/DcaManager.sol#L314)

	```solidity
	            _rBtcPurchaseChecksEffects(buyers[i], token, scheduleIndexes[i], scheduleIds[i]);
	```

- Found in src/External interaction examples/SovrynDepositWithdraw.sol [Line: 40](src/External interaction examples/SovrynDepositWithdraw.sol#L40)

	```solidity
	        docToken.transferFrom(msg.sender, address(this), amount);
	```

- Found in src/External interaction examples/SovrynDepositWithdraw.sol [Line: 41](src/External interaction examples/SovrynDepositWithdraw.sol#L41)

	```solidity
	        docToken.approve(address(loanTokenProxy), amount);
	```

- Found in src/External interaction examples/SovrynDepositWithdraw.sol [Line: 42](src/External interaction examples/SovrynDepositWithdraw.sol#L42)

	```solidity
	        loanTokenProxy.mint(address(this), amount);
	```

- Found in src/External interaction examples/SovrynDepositWithdraw.sol [Line: 53](src/External interaction examples/SovrynDepositWithdraw.sol#L53)

	```solidity
	        loanTokenProxy.burn(msg.sender, iSusdToRepay);
	```

- Found in src/PurchaseMoc.sol [Line: 87](src/PurchaseMoc.sol#L87)

	```solidity
	        _batchRedeemStablecoin(buyers, purchaseAmounts, totalDocAmountToSpend + aggregatedFee); // total DOC to redeem by repaying kDOC in order to spend it to redeem rBTC is totalDocAmountToSpend + aggregatedFee
	```

- Found in src/SovrynErc20Handler.sol [Line: 110](src/SovrynErc20Handler.sol#L110)

	```solidity
	        _redeemStablecoin(user, stablecoinInterestAmount, exchangeRate, user);
	```

- Found in src/TropykusErc20Handler.sol [Line: 84](src/TropykusErc20Handler.sol#L84)

	```solidity
	        _redeemStablecoin(user, withdrawalAmount, exchangeRate);
	```

</details>



